function responsiveStartup(){var e=PnPResponsiveApp.Main.getInstance();e.addViewport(),e.init()}window.hasOwnProperty("Type")?Type.registerNamespace("PnPResponsiveApp"):window.PnPResponsiveApp=window.PnPResponsiveApp||{},PnPResponsiveApp.Main=function(){var e,o=!1,i=!1,k=!1;function s(e,t){if(u(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}else e.className=e.className+" "+t}function u(e,t){try{return-1!==(" "+e.className+" ").indexOf(" "+t+" ")}catch(e){return!1}}function m(e){e.id=e.getAttribute("id")+"_mobileClone";for(var t=e.getElementsByTagName("*"),n=new RegExp("(.*?zz.*?(?:_SiteActionsMenuMain|_SiteActionsMenu))","g"),i=0;i<t.length;i++)if(t[i].id){for(var o=t[i].attributes,a=0;a<o.length;a++)"id"!=o[a].name&&(o[a].value=o[a].value.replace(n,"$1_mobileClone"));t[i].id=t[i].getAttribute("id")+"_mobileClone"}return e}function a(){if(!(window.location.href.indexOf("/settings.aspx")<0)){var e=document.getElementsByClassName("ms-siteSettings-root")[0];if(e){for(var t=e.getElementsByClassName("ms-linksection-level1"),n=0;n<t.length;n++){var i=t[n],o=document.createElement("div");o.className="pnp-settingsdiv",o.appendChild(i.getElementsByTagName("img")[0]),o.appendChild(i.getElementsByClassName("ms-linksection-textCell")[0]),e.appendChild(o)}e.getElementsByTagName("table")[0]&&e.removeChild(e.getElementsByTagName("table")[0])}else setTimeout(a,100)}}function p(){window.location.href.indexOf("/designbuilder.aspx")<0||k||function(e,t,n,i){try{new CUI.BuildOptions}catch(e){return}var o=new CUI.BuildOptions;o.lazyMenuInit=!0,o.trimmedIds={},o.attachToDOM=!1,o.validateServerRendering=!1,o.fixedPositioningEnabled=!1,o.dataExtensions=null,o.clientID="ms-designbuilder-cuicontainer_mobileClone";try{SP.Ribbon.PageManager.get_instance()}catch(e){return}var a=document.getElementById("ms-designbuilder-cuicontainer_mobileClone");if(!Boolean(a))return;a.innerHTML="";var l=new CUI.RootProperties;l.Culture=t,l.DecimalSeparator=n,l.RootEventCommand="designBuilderRootEventCommand",l.ImageDownArrow=GetThemedImageUrl("spcommon.png"),l.ImageDownArrowTop="-256",l.ImageDownArrowLeft="-104",l.TextDirection=i;var r=SP.Ribbon.PageManager.get_instance(),d=new CUI.Builder(o,a,r);g_designBuilderControlRoot=new CUI.StandaloneRoot("DesignBuilderTools",l),g_designBuilderControlRoot.setBuilder(d),r.addRoot(g_designBuilderControlRoot),function(){var e=g_designData,t=g_designBuilderControlRoot,n=null,i=encodeURIComponent(e.newThemesLocation.toUpperCase()),o=!0,a="true"==e.overrideThemesLocation.toLowerCase();if(a){var l=g_desbld_designGuid,r=g_desbld_designVersion;o=null==g_desbld_designGuid||"undefined"==g_desbld_designGuid||null==g_desbld_designVersion||"undefined"==g_desbld_designVersion,null!=(n=GetSelectedDesignPackageFolder(o,l,r))&&""!=n&&(n=n.toUpperCase())}var d=document.getElementById("ms-designbuilder-cuicontainer_mobileClone"),s=CreateLabelElement(Strings.STS.L_DesignBuilderToolsPaletteLabel,"ms-designbuilder-palette-Medium");d.appendChild(s);var u,m,c,p=0,g=[],v=!1,C=g_desbld_themeUrl;for(m in e.themes)if(c=m.toUpperCase(),!a||o&&-1==c.indexOf(i)||!o&&(-1==c.indexOf(i)||-1!=c.indexOf(n))){var f=e.themes[m];null==window.OffSwitch||OffSwitch.IsActive("F21AA66C-5CE7-4EA8-AE05-BA6E16A1A182")?v||decodeURI(f.ServerRelativeUrl.toUpperCase())!=decodeURI(C.toUpperCase())||(u=m,v=!0):v||unescapeProperly(f.ServerRelativeUrl.toUpperCase())!=unescapeProperly(C.toUpperCase())||(u=m,v=!0),g.push(CreatePaletteGalleryButtonXml(m,f,p++))}var h=g.join(""),B=['<DropDown Id="ms-designbuilder-palette" Alt="',Strings.STS.L_DesignBuilderToolsPaletteAlt,'" Command="PalettePickerSelected" QueryCommand="PalettePickerQuery" CommandPreview="PalettePickerPreview" CommandRevert="PalettePickerPreviewRevert" Width="111px" SelectedItemDisplayMode="Menu" InitialItem="',u,'"><Menu Id="DesignBuilderTools.Palette.Menu"><MenuSection Id="ms-designbuilder-palette-menusection" MaxHeight="269px" Scrollable="true"><Controls Id="DesignBuilderTools.Palette.Menu.MenuSection.Controls">',h,"</Controls></MenuSection></Menu></DropDown>"];t.addControl("DesignBuilderTools.Palette",B.join(""));var y=t.getDOMElementForControlDisplayMode("DesignBuilderTools.Palette","Medium");d.appendChild(y);var P=CreateLabelElement(Strings.STS.L_DesignBuilderToolsLayoutLabel,"ms-designbuilder-layout-Medium");d.appendChild(P),p=0,g=[],v=!1,u=null;var b=g_desbld_masterUrl;for(m in e.preview)if(c=m.toUpperCase(),!a||o&&-1==c.indexOf(i)||!o&&(-1==c.indexOf(i)||-1!=c.indexOf(n))){var E=e.preview[m];v||decodeURI(m.toUpperCase())!=decodeURI(b.toUpperCase())||(u=m,v=!0),g.push(CreateLayoutButtonXml(m,E,p++))}h=g.join("");var S=['<DropDown Id="ms-designbuilder-layout" Alt="',Strings.STS.L_DesignBuilderToolsLayoutAlt,'" Command="LayoutPickerSelected" QueryCommand="LayoutPickerQuery" CommandPreview="LayoutPickerPreview" CommandRevert="LayoutPickerPreviewRevert" Width="103px" InitialItem="',u,'"><Menu Id="DesignBuilderTools.Layout.Menu"><MenuSection Id="ms-designbuilder-layout-menusection"><Controls Id="DesignBuilderTools.Layout.Menu.MenuSection.Controls">',h,"</Controls></MenuSection></Menu></DropDown>"];t.addControl("DesignBuilderTools.Layout",S.join(""));var I=t.getDOMElementForControlDisplayMode("DesignBuilderTools.Layout","Medium");d.appendChild(I);var D=CreateLabelElement(Strings.STS.L_DesignBuilderToolsFontLabel,"ms-designbuilder-fontscheme-Medium");d.appendChild(D),p=0,g=[],v=!1;var w=(u=null)===g_desbld_fontSchemeUrl?null:g_desbld_fontSchemeUrl;if(null===w||"DEFAULT"===w.toUpperCase()){var M=GetItemIgnoreCase(e.preview,b);Boolean(M)&&Boolean(M.defaultFontScheme)&&(w=M.defaultFontScheme)}var N,T=w.toUpperCase(),_=e.fontSchemeDuplicateKeyCount,A=new Array(_);for(m in e.fontSchemes)N=e.fontSchemeDuplicateKeys[m],Boolean(A[N])&&(v||decodeURI(m.toUpperCase())!=decodeURI(T))||(A[N]=m);v=!1;for(var L=0;L<A.length;L++)if(m=A[L],c=m.toUpperCase(),!a||o&&-1==c.indexOf(i)||!o&&(-1==c.indexOf(i)||-1!=c.indexOf(n))){var U=e.fontSchemes[m];v||decodeURI(c)!=decodeURI(T)||(u=m,v=!0),g.push(CreateFontSchemeButtonXml(m,U,p++))}h=g.join("");var R=['<DropDown Id="ms-designbuilder-fontscheme" Alt="',Strings.STS.L_DesignBuilderToolsFontSchemeAlt,'" Command="FontSchemePickerSelected" QueryCommand="FontSchemePickerQuery" Width="132px" SelectedItemDisplayMode="Menu" InitialItem="',u,'"><Menu Id="DesignBuilderTools.FontScheme.Menu"><MenuSection Id="ms-designbuilder-fontscheme-menusection"><Controls Id="DesignBuilderTools.FontScheme.Menu.MenuSection.Controls">',h,"</Controls></MenuSection></Menu></DropDown>"];t.addControl("DesignBuilderTools.FontScheme",R.join(""));var x=t.getDOMElementForControlDisplayMode("DesignBuilderTools.FontScheme","Medium");d.appendChild(x),t.pollForStateAndUpdate(),k=!0}()}(_spPageContextInfo.currentCultureLCID,_spPageContextInfo.currentCultureName,".",document.getElementsByTagName("html")[0].getAttribute("dir"))}function g(e){var t=document.getElementById(e),n=null;if(t){(n=m(n=t.cloneNode(!0))).className+=" ms-qSuggest-listSeparator";for(var i=n.querySelectorAll("li"),o=0;o<i.length;o++){var a=i[o].getElementsByClassName("menu-item")[0],l=document.createElement("div");if(l.className="ms-core-menu-item",0<i[o].getElementsByTagName("ul").length&&a){u(i[o],"dynamic-children")||(i[o].className=i[o].className+" dynamic-children");var r=document.createElement("button");r.type="button",l.appendChild(r),r.addEventListener("click",function(){return s(this.parentNode.parentNode,"expand"),!1})}a&&(i[o].insertBefore(l,i[o].firstElementChild),l.appendChild(a)),i[o].insertBefore(l,i[o].firstElementChild);var d=i[o].querySelector("a.ms-navedit-editLinksText");d&&(d.removeAttribute("onclick"),d.href=_spPageContextInfo.webServerRelativeUrl+"/_layouts/15/AreaNavigationSettings.aspx")}}return n}function v(e,t){var n=!1;return t?n=!0:u(e,"pnp-nodeListener")||(e.className+=" pnp-nodeListener",e.addEventListener("DOMNodeInserted",function(){PnPResponsiveApp.Main.setUpToggling()})),n}function C(){var e=document.getElementById("PnPNavPanel"),t=document.getElementById("PnPPanelPage");e&&s(e,"PnPPanelEnabled"),t&&s(t,"PnPPanelEnabled")}return{init:function(){if(!o){var e,t=document.getElementById("PnPResponsiveUI");if(null!=t&&(e=t.src),null==e){var n=document.querySelectorAll("script[src*='sp-responsive-ui.js']");0<n.length&&(e=n[0].src)}if(null!=e)!function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.appendChild(n)}(e.substring(0,e.lastIndexOf("/")+1)+"sp-responsive-ui.css");PnPResponsiveApp.Main.setUpToggling(),PnPResponsiveApp.Main.setUpSuiteBarToogling(),a(),window.onhashchange=function(){a()};var i=FixRibbonAndWorkspaceDimensions;FixRibbonAndWorkspaceDimensions=function(){i(),document.getElementById("s4-bodyContainer").style.width=document.getElementById("s4-workspace").offsetWidth+"px"}}o=!0},addViewport:function(){if(!i){var e=document.getElementsByTagName("head")[0],t=document.createElement("meta");t.name="viewport",t.content="width=device-width, user-scalable=yes, initial-scale=1.0";var n=document.createElement("meta");n.name="apple-mobile-web-app-capable",n.content="yes",e.appendChild(t),e.appendChild(n)}i=!0},setUpToggling:function(){var e=document.getElementsByClassName("ms-dialogBody");if(!(null!=e&&0<e.length||document.getElementById("PnP_MainLink_Hamburger"))){var t=document.getElementById("suiteBarTop"),n=null;if(t){if(!(n=t.getElementsByClassName("o365cs-nav-leftAlign")[0])){var i=t.querySelector("#O365_NavHeader");i&&(n=i.firstElementChild)}if(!v(t,n))return}else if(n=(n=(t=document.getElementById("suiteBar"))?t.querySelector(".ms-verticalAlignMiddle"):null)?n.parentNode:null,!t&&!v(document.getElementById("aspnetForm"),t))return;if(n){if(n.insertBefore(function(){var e=document.createElement("div");e.className="o365cs-nav-topItem o365cs-rsp-m-hide o365cs-rsp-tn-hideIfAffordanceOn mobile-only";var t=document.createElement("div"),n=document.createElement("button");n.type="button",n.className="o365cs-nav-item o365cs-nav-button ms-bgc-tdr-h o365button o365cs-topnavText o365cs-navMenuButton ms-bgc-tp ms-button-emphasize mobile-only",n.id="PnP_MainLink_Hamburger",n.setAttribute("role","menuitem"),n.setAttribute("aria-disabled","false"),n.setAttribute("aria-selected","false"),n.setAttribute("aria-label","Open the menu to access additional app options");var i=document.createElement("span");return i.className="ms-rteThemeBackColor-1-0 ms-Icon--GlobalNavButton",i.setAttribute("aria-hidden","true"),n.addEventListener("click",function(){return C(),p(),!1}),n.appendChild(i),t.appendChild(n),e.appendChild(t),e}(),n.firstElementChild),document.getElementById("PnPNavPanel"))return;var o=document.getElementById("suiteBarDelta");if(o||(o=document.getElementById("suiteBar")),!o)return;var a=document.createElement("div");a.id="PnPPanelPage";var l=document.createElement("div");l.id="PnPNavPanel",l.className="ms-rteThemeBackColor-1-0 ms-dialogHidden mobile-only ms-hide";var r=document.createElement("div");r.id="PnPContentNavPanel";var d=g("DeltaPlaceHolderProfileImage");d&&r.appendChild(d);var s=g("DeltaTopNavigation");s&&r.appendChild(s);var u=g("DeltaPlaceHolderLeftNavBar");u&&(r.appendChild(u),document.getElementById("DeltaPlaceHolderLeftNavBar").addEventListener("DOMSubtreeModified",function(){var e=document.getElementById("PnPContentNavPanel");if(e){var t=g(this.id),n=e.querySelector("#"+t.id);n&&n.parentNode.removeChild(n);var i=e.getElementsByClassName("PnPPanelBottom")[0];i?e.insertBefore(t,i):e.appendChild(t)}}));var m=g("DeltaHorizontalQuickLaunch");m&&r.appendChild(m);var c=document.createElement("div");c.className="PnPPanelBottom",r.appendChild(c),l.appendChild(r),o.parentElement.insertBefore(l,o.nextSibling),o.parentElement.insertBefore(a,l.nextSibling),a.addEventListener("click",function(){return C(),!1})}}},setUpSuiteBarToogling:function(){if(document.getElementById("suiteBar")){var e=document.createElement("button");e.id="pnp-suiteBar-open",e.className="mobile-only ms-button-emphasize",e.type="button";var t=document.createElement("span");t.className="ms-rteThemeBackColor-1-0",t.setAttribute("aria-hidden","true"),e.addEventListener("click",function(){document.getElementById("pnp-suiteBar")&&s(document.getElementById("pnp-suiteBar"),"ms-hide")}),e.appendChild(t),document.getElementById("DeltaSuiteLinks").appendChild(e)}PnPResponsiveApp.Main.setUpSuiteBarRwd()},setUpSuiteBarRwd:function(){if(!document.getElementById("pnp-suiteBar")&&document.getElementById("suiteBar")){var e=document.getElementById("suiteBarButtons").cloneNode(!0);e=m(e);var t=document.getElementById("suiteLinksBox").cloneNode(!0);t=m(t);var n=document.createElement("div");n.id="pnp-suiteBar",n.className="mobile-only ms-rteThemeBackColor-5-0 ms-hide";var i=document.createElement("button");i.id="pnp-suiteBar-close",i.type="button",i.className="ms-button-emphasize",i.addEventListener("click",function(){s(document.getElementById("pnp-suiteBar"),"ms-hide")}),n.appendChild(i),n.appendChild(e),n.appendChild(t),document.getElementById("suiteBar").parentNode.insertBefore(n,document.getElementById("suiteBar"))}},getInstance:function(){return e||(e=this),e}}}(),SP.SOD.executeFunc("sp.js","SP.ClientContext",responsiveStartup),_spBodyOnLoadFunctionNames.push("responsiveStartup");